-- Percsploit Multi Loader (Fixed for Mobile + PC)
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled

-- ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "PercsploitMultiLoader"
ScreenGui.Parent = PlayerGui
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false

-- Startup Frame (for PC)
local StartupFrame = Instance.new("Frame")
StartupFrame.Size = UDim2.new(1, 0, 1, 0)
StartupFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
StartupFrame.BackgroundTransparency = 0
StartupFrame.ZIndex = 10
StartupFrame.Parent = ScreenGui

local StarImage = Instance.new("ImageLabel")
StarImage.Size = UDim2.new(0, 100, 0, 100)
StarImage.Position = UDim2.new(0.5, -50, 0.5, -50)
StarImage.BackgroundTransparency = 1
StarImage.Image = "rbxassetid://7051121336"
StarImage.ImageColor3 = Color3.fromRGB(128, 0, 128)
StarImage.Parent = StartupFrame

-- MainFrame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 300, 0, 400)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
MainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = not isMobile
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 10)
UICorner.Parent = MainFrame

local UIGradient = Instance.new("UIGradient")
UIGradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(128, 0, 128)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 105, 180))
}
UIGradient.Parent = MainFrame

-- Title
local TitleLabel = Instance.new("TextLabel")
TitleLabel.Size = UDim2.new(1, 0, 0, 50)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Text = "Percsploit Multi Loader"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 24
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.TextStrokeTransparency = 0.8
TitleLabel.TextStrokeColor3 = Color3.fromRGB(128, 0, 128)
TitleLabel.Parent = MainFrame

-- KeyInput
local KeyInput = Instance.new("TextBox")
KeyInput.Size = UDim2.new(0.9, 0, 0, 40)
KeyInput.Position = UDim2.new(0.05, 0, 0, 60)
KeyInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
KeyInput.Text = "Enter your key here"
KeyInput.TextColor3 = Color3.fromRGB(200, 200, 200)
KeyInput.TextSize = 16
KeyInput.Font = Enum.Font.Gotham
KeyInput.Parent = MainFrame

local KeyCorner = Instance.new("UICorner")
KeyCorner.CornerRadius = UDim.new(0, 5)
KeyCorner.Parent = KeyInput

-- ScrollFrame
local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Size = UDim2.new(0.9, 0, 0, 270)
ScrollFrame.Position = UDim2.new(0.05, 0, 0, 110)
ScrollFrame.BackgroundTransparency = 1
ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
ScrollFrame.ScrollBarThickness = 5
ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(128, 0, 128)
ScrollFrame.Parent = MainFrame

local layout = Instance.new("UIListLayout")
layout.Padding = UDim.new(0, 10)
layout.Parent = ScrollFrame

local scripts = {
	{name = "Arcade Basketball", url = "https://api.luarmor.net/files/v3/loaders/4b9b7b3daa96e24fb09b4451abe2fd50.lua"},
	{name = "Hoop Heroes", url = "https://api.luarmor.net/files/v3/loaders/12d8d6a43ade4627ec3bdfe242435a82.lua"},
	{name = "Flag Football", url = "https://api.luarmor.net/files/v3/loaders/16e1671cf1b0e5b6df8b20fa921a7294.lua"},
	{name = "Practical Basketball", url = "https://api.luarmor.net/files/v3/loaders/01b608f4b8e66b0be97fe3ff518726fd.lua"},
	{name = "Playground Basketball", url = "https://api.luarmor.net/files/v3/loaders/1f7d065fdc92ad0c0b92994a16c1b97f.lua"}
}

for _, s in ipairs(scripts) do
	local Button = Instance.new("TextButton")
	Button.Size = UDim2.new(1, 0, 0, 40)
	Button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	Button.Text = s.name
	Button.TextColor3 = Color3.fromRGB(255, 255, 255)
	Button.TextSize = 16
	Button.Font = Enum.Font.Gotham
	Button.Parent = ScrollFrame

	local BtnCorner = Instance.new("UICorner")
	BtnCorner.CornerRadius = UDim.new(0, 5)
	BtnCorner.Parent = Button

	local BtnGradient = Instance.new("UIGradient")
	BtnGradient.Color = ColorSequence.new{
		ColorSequenceKeypoint.new(0, Color3.fromRGB(128, 0, 128)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 105, 180))
	}
	BtnGradient.Parent = Button

	Button.MouseButton1Click:Connect(function()
		local key = KeyInput.Text
		if key == "" or key == "Enter your key here" then
			game:GetService("StarterGui"):SetCore("SendNotification", {
				Title = "Error", Text = "Please enter a valid key", Duration = 3
			})
			return
		end
		local success, result = pcall(function()
			local sc = game:HttpGet(s.url, true)
			local code = string.format("script_key='%s';%s", key, sc)
			loadstring(code)()
		end)
		if success then
			game:GetService("StarterGui"):SetCore("SendNotification", {
				Title = "Success", Text = s.name.." executed successfully!", Duration = 3
			})
		else
			game:GetService("StarterGui"):SetCore("SendNotification", {
				Title = "Error", Text = tostring(result), Duration = 3
			})
		end
	end)
end

ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, #scripts * 50 + 10)

-- Minimize + Drag Icon
local IconButton = Instance.new("ImageButton")
IconButton.Size = UDim2.new(0, 50, 0, 50)
IconButton.Position = UDim2.new(0.05, 0, 0.8, 0)
IconButton.BackgroundTransparency = 1
IconButton.Image = "rbxassetid://7051121336"
IconButton.ImageColor3 = Color3.fromRGB(170, 0, 255)
IconButton.Visible = isMobile
IconButton.Parent = ScreenGui

-- Dragging for icon
local draggingIcon, dragInput, dragStart, startPos
IconButton.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
		draggingIcon = true
		dragStart = input.Position
		startPos = IconButton.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				draggingIcon = false
			end
		end)
	end
end)
IconButton.InputChanged:Connect(function(input)
	if draggingIcon and (input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement) then
		local delta = input.Position - dragStart
		IconButton.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)

-- Toggle Menu
local menuVisible = true
local function toggleMenu()
	menuVisible = not menuVisible
	MainFrame.Visible = menuVisible
end
IconButton.MouseButton1Click:Connect(toggleMenu)

-- PC Minimize shortcut
UserInputService.InputBegan:Connect(function(input, processed)
	if not processed and input.KeyCode == Enum.KeyCode.RightControl then
		toggleMenu()
	end
end)

-- TextBox placeholders
KeyInput.Focused:Connect(function()
	if KeyInput.Text == "Enter your key here" then
		KeyInput.Text = ""
	end
end)
KeyInput.FocusLost:Connect(function()
	if KeyInput.Text == "" then
		KeyInput.Text = "Enter your key here"
	end
end)

-- Skip startup instantly for mobile
if isMobile then
	StartupFrame:Destroy()
	MainFrame.Visible = true
else
	local spinTween = TweenService:Create(StarImage, TweenInfo.new(2), {Rotation = 360})
	local growTween = TweenService:Create(StarImage, TweenInfo.new(1), {Size = UDim2.new(0, 200, 0, 200)})
	spinTween:Play()
	growTween:Play()
	growTween.Completed:Connect(function()
		local fadeTween = TweenService:Create(StartupFrame, TweenInfo.new(0.5), {BackgroundTransparency = 1})
		local imageFade = TweenService:Create(StarImage, TweenInfo.new(0.5), {ImageTransparency = 1})
		fadeTween:Play()
		imageFade:Play()
		imageFade.Completed:Connect(function()
			StartupFrame:Destroy()
			MainFrame.Visible = true
		end)
	end)
end

-- Dragging MainFrame
local draggingFrame, startInput, startPosFrame, dragStartFrame
MainFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		draggingFrame = true
		dragStartFrame = input.Position
		startPosFrame = MainFrame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				draggingFrame = false
			end
		end)
	end
end)
MainFrame.InputChanged:Connect(function(input)
	if draggingFrame and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
		local delta = input.Position - dragStartFrame
		MainFrame.Position = UDim2.new(startPosFrame.X.Scale, startPosFrame.X.Offset + delta.X, startPosFrame.Y.Scale, startPosFrame.Y.Offset + delta.Y)
	end
end)
